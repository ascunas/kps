<!DOCTYPE html>
<html lang="ko">
<head>
<title>ê·¼íƒœì‹ ì²­ ë©”ì¸</title>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />

<script type="text/javascript" src="../js/jquery-3.7.1.js"></script>
<script type="text/javascript" src="../js/common.js"></script>
<script type="text/javascript" src="../js/lib/gridjs.umd.js"></script>
<script type="text/javascript" src="../js/lib/chart.js"></script>
<script type="text/javascript" src="../js/lib/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="../js/lib/bootstrap-datepicker.ko.min.js"></script>
<script type="text/javascript" src="../js/lib/select2.min.js"></script>

<link type="text/css" rel="stylesheet" href="../css/common.css" />
<link type="text/css" rel="stylesheet" href="../css/mermaid.min.css" />
<link type="text/css" rel="stylesheet" href="../css/bootstrap-datepicker3.css" />
<link type="text/css" rel="stylesheet" href="../css/select2.min.css" />
<link type="text/css" rel="stylesheet" href="../css/style.css" />
<script type="text/javascript">
//<![CDATA[
/* Publishing-Div current page scripts... */

jQuery(function() {
	var $ = jQuery;

    $('.input-daterange').datepicker({
        format: "yyyy.mm.dd",
        language: "ko",
        forceParse: false,
        autoclose: true,
        todayHighlight: true,
        orientation: 'bottom',
        widgetPositioning: { horizontal: 'auto', vertical: 'auto' }
    });
    
    $(document).ready(function() {

        // ë¹ˆ ë°ì´í„° ì˜ˆì œ
        const emptyData = [];

        // grid.js ì´ˆê¸°í™”
        new gridjs.Grid({
            columns: ["ë²ˆí˜¸", "ì´ë¦„", "ë¶€ì„œ", "ì§ê¸‰"],
            data: emptyData,
            search: false,
            pagination: false,
            sort: false,
            language: {
                noRecordsFound: "ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",   // ë°ì´í„° ì—†ì„ ë•Œ í‘œì‹œ ë¬¸êµ¬
            }
        }).render(document.getElementById("emptyGrid"));

        
        // ì‹ ì²­ë‚´ì—­ ê·¸ë¦¬ë“œ
        const sampleData = [
            ["ê¸°ì•ˆ", "ì‹ ê·œ", "ì—°ì°¨", "2025.10.10~2025.10.13", "16ì‹œê°„", true, "ê°œì¸ì‚¬ì •", "í™ê¸¸ë™", "ê¹€íŒ€ì¥", "2025.10.13", "12345678"],
            ["ì €ì¥", "ë³€ê²½í›„", "ì—°ì°¨(ì˜¤í›„)", "2025.10.10 14:00~18:00", "4ì‹œê°„", true, "ê°œì¸ì‚¬ì •", "ì´ì˜í¬", "ë°•ë¶€ì¥", "2025.10.13", "87654321"],
            ["ê²°ì¬", "ë³€ê²½ì „", "ì—°ì°¨(ì˜¤ì „)", "2025.10.10 09:00~14:00", "4ì‹œê°„", true, "ê°œì¸ì‚¬ì •", "ì´ì˜í¬", "ë°•ë¶€ì¥", "2025.10.13", "87654321"],
            ["ê²°ì¬", "ì·¨ì†Œ", "ê²½ì¡°íœ´ê°€(ë°°ìš°ì ì™¸ì¡°ë¶€ìƒ)", "2025.10.13~2025.10.15", "3ì¼", true, "ê°€ì¡±ê²½ì¡°ì‚¬", "ë°•ì§€í›ˆ", "ê¹€íŒ€ì¥", "2025.10.13", "45671234"],
            ["ë°˜ë ¤", "ì‹ ê·œ", "ë³‘ê°€", "2025.10.15", "8ì‹œê°„", false, "ë…ê°", "ìµœë¯¼ìˆ˜", "ì´ë¶€ì¥", "2025.10.13", "78945612"],
            ["ì™„ë£Œ", "ì‹ ê·œ", "ë³‘ê°€", "2025.10.15", "8ì‹œê°„", true, "ê°ê¸°", "ê¹€í•˜ëŠ˜", "ë°•íŒ€ì¥", "2025.10.14", "11223344"]
        ];

        // ìƒíƒœ â†’ ë¼ë²¨ HTML
        function renderStatusLabel(status) {
            const map = {
                "ê¸°ì•ˆ": "status-draft",
                "ê²°ì¬": "status-approved",
                "ë°˜ë ¤": "status-rejected",                
                "ì €ì¥": "status-saved",
                "ì™„ë£Œ": "status-completed",
            };
            const cls = map[status] || "status-draft";
            return gridjs.html(`<span class="status-label ${cls}">${status}</span>`);
        }

        // ì²¨ë¶€íŒŒì¼ ì•„ì´ì½˜
        function renderFileIcon(hasFile) {
            return hasFile ? gridjs.html(`<span class="file-icon">ğŸ“</span>`) : "";
        }

        // ê·¼íƒœìœ í˜• â†’ ìƒì„¸í˜ì´ì§€ ë§í¬
        function renderDetailLink(cell, rowIndex) {
            const detailUrl = `/attendance-detail.html?id=${rowIndex + 1}`;
            return gridjs.html(`<a href="${detailUrl}" class="detail-link">${cell}</a>`);
        }

        // ëª¨ë“  ì…€ì— div ë˜í•‘
        function wrapInDiv(cell) {
            const content = cell !== null && cell !== undefined ? cell.toString() : '';
            return gridjs.html(`<div class="cell-wrapper">${content}</div>`);
        }

        // Grid.js ì´ˆê¸°í™”
        new gridjs.Grid({
            columns: [
                {
                    name: "ìƒíƒœ",
                    formatter: (cell) => renderStatusLabel(cell),
                    width: "80px",
                    attributes: {
                        class: "status-cell"
                    }
                },
                {
                    name: "êµ¬ë¶„",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ê·¼íƒœìœ í˜•",
                    formatter: (cell, row, index) => renderDetailLink(cell, index),
                    attributes: {
                        style: "text-align: left;"
                    }
                },
                {
                    name: "ê·¼íƒœê¸°ê°„",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ì¼/ì‹œê°„",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ì²¨ë¶€íŒŒì¼",
                    formatter: (cell) => renderFileIcon(cell),
                    width: "90px"
                },
                {
                    name: "ê·¼íƒœì‚¬ìœ ",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ì‹ ì²­ì",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ê²°ì¬ì",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ê²°ì¬ì¼",
                    formatter: (cell) => wrapInDiv(cell)
                },
                {
                    name: "ê²°ì¬ë²ˆí˜¸",
                    formatter: (cell) => wrapInDiv(cell)
                }
            ],
            data: sampleData,
            //search: {
            //    enabled: true
            //},
            sort: true,
            //pagination: {
                //enabled: true,
                //limit: 5,
                //summary: true
            //},
            resizable: true,
            autoWidth: true,
            
            language: {
            noRecordsFound: "ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",   // ë°ì´í„° ì—†ì„ ë•Œ í‘œì‹œ ë¬¸êµ¬
            },
            className: {
                table: 'my-custom-table',
                thead: 'my-thead',
                tbody: 'my-tbody',
                container: 'my-grid-wrap'
            }
        }).render(document.getElementById("attendanceGrid"));


        // ê³µí†µ ì…€ ë˜í¼ í•¨ìˆ˜
        function wrapCell(content) {
            return gridjs.html(`<div class="cell-wrapper">${content ?? ""}</div>`);
        }

        // ì—°ì°¨ì¿¼í„° ìƒì„¸ ë°ì´í„°
        const annualData = [
            ["ë‹¹í•´ì—°ì°¨", "2024.11.19", "2028.11.18", "184.00", "0.00", "184.00"],
            ["ì´ì›”ì—°ì°¨", "2024.11.19", "2028.11.18", "176.00", "88.00", "88.00"],
            ["ì´ì›”ì—°ì°¨", "2024.11.19", "2028.11.18", "176.00", "176.00", "0.00"],
            ["ì´ì›”ì—°ì°¨", "2024.11.19", "2028.11.18", "176.00", "176.00", "0.00"],
            ["", "", "ì†Œê³„", "712.00", "440.00", "272.00"],
            ["ì„ ì‚¬ìš©", "2024.11.19", "2028.11.18", "80.00", "0.00", "80.00"],
            ["", "", "í•©ê³„", "792.00", "440.00", "352.00"]
        ];

        // Grid ìƒì„±
        const grid = new gridjs.Grid({
            columns: [
            { name: "êµ¬ë¶„", formatter: (cell) => wrapCell(cell) },
            { name: "ìƒì„±ì¼", formatter: (cell) => wrapCell(cell) },
            { name: "ì†Œë©¸ì¼", formatter: (cell) => wrapCell(cell) },
            { name: "ë°œìƒ", formatter: (cell) => wrapCell(cell), attributes: { style: "text-align:right;" } },
            { name: "ì‚¬ìš©", formatter: (cell) => wrapCell(cell), attributes: { style: "text-align:right;" } },
            { name: "ì”ì—¬", formatter: (cell) => wrapCell(cell), attributes: { style: "text-align:right;" } }
            ],
            data: annualData,
            sort: false,
            search: false,
            pagination: false
        }).render(document.getElementById("annualGrid"));

        // Grid ë Œë” ì™„ë£Œ í›„ í–‰ë³„ class ë¶€ì—¬
        setTimeout(() => {
            const rows = document.querySelectorAll("#annualGrid table tbody tr");
            rows.forEach((row) => {
            const cells = row.querySelectorAll("td");
            if (!cells.length) return;
            const label = cells[2]?.textContent?.trim();
            if (label === "ì†Œê³„") {
                row.classList.add("subtotal-row");
            } else if (label === "í•©ê³„") {
                row.classList.add("total-row");
            }
            });
        }, 300);
    });

    
    
    // ì—°ì°¨ì¿¼í„° ë„ìš°ë„› ì± íŠ¸
    const ctx = $('#myDoughnutChart')[0].getContext('2d');

    const chartOptions = {
        layout: {
            padding: {
                top: 15,
                bottom: 15
            }
        }
    };

    const myDoughnutChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['ë°œìƒ', 'ì‚¬ìš©', 'ì”ì—¬'],
            datasets: [{
                label: 'ì—°ì°¨ì¿¼í„°',
                data: [300, 50, 100],
                pointStyle: 'rect',
                backgroundColor: [
                    'rgba(12, 77, 162, 0.8)',
                    'rgba(141, 182, 244, 0.8)',
                    'rgba(223, 236, 253, 0.8)'
                ],
                borderColor: [
                    'rgba(12, 77, 162, 1)',
                    'rgba(141, 182, 244, 1)',
                    'rgba(223, 236, 253, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: "82%",
            plugins: {
                tooltip: {
                    backgroundColor: "#000",
                    bodyColor: "#858796",
                    borderColor: '#dddfeb',
                    borderWidth: 1,
                    padding: 15,
                    displayColors: false,
                    caretPadding: 10,
                },
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#000',
                        padding: 20,
                        boxWidth: 10,
                        boxHeight: 10,
                        font: {
                            family: 'Pretendard',
                            size: 14,
                            weight: '500'
                        }
                    },
                },
                title: {
                    display: false,
                    text: 'ë„ë„› ì°¨íŠ¸ ì˜ˆì œ'
                }
            },
            layout: {
                padding: {
                    top: 0,
                    bottom: 0
                }
            }
        }
    });

});

</script>
</head>
<body>
<div class="content-page">
    <div class="page-header">
        <h2 class="">ê·¼íƒœì‹ ì²­</h2>
        <div class="breadcrumbs">
            <ul>
                <li class="first">í™ˆ</li>
                <li>ESS</li>
                <li>ê·¼ë¬´/ê·¼íƒœ</li>
                <li class="current">ê·¼íƒœì‹ ì²­</li>
            </ul>
        </div>
    </div>
    <div class="page-layout grid">
        <div class="box open-modal-btn" data-target="modal1111">
            <div class="header">
                <div class="title">
                    <h3>ì—°ì°¨ì¿¼í„°</h3>
                    <span class="unit">ì—°ì°¨ê¸°ì‚°ì¼ 2025.10.25</span>
                </div>
                <span class="unit">ë°œìƒ / ì‚¬ìš© / ì”ì—¬</span>
            </div>
            <div class="body">
                <div class="body-wrap">
                    <div class="" style="width: 55%">
                        <canvas id="myDoughnutChart" style="display: block; box-sizing: border-box; height: 50%; width: 50%;"></canvas>
                    </div>
                    <div class="progress-con">
                        <div class="progress">
                            <span class="label">ë‹¹í•´</span>
                            <div class="progress-wrap type1">
                                <div class="progress-bar" style="width: 85%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                        <div class="progress">
                            <span class="label">ì´ì›”</span>
                            <div class="progress-wrap type1">
                                <div class="progress-bar" style="width: 45%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                        <div class="progress">
                            <span class="label">ì„ ì‚¬ìš©</span>
                            <div class="progress-wrap type1">
                                <div class="progress-bar" style="width: 0%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="box">
            <div class="header">
                <div class="title">
                    <h3>ê¸°íƒ€ íœ´ê°€ì¿¼í„°</h3>
                    <span class="unit">ì¢Œì¸¡ : ì‹œê°„, ìš°ì¸¡ : ì¼</span>
                </div>
                <span class="unit">ë°œìƒ / ì‚¬ìš© / ì”ì—¬</span>
            </div>
            <div class="body-wrap">
                <div class="progress-con">
                    <div class="progress">
                        <div>
                            <span class="label">ì§ˆë³‘</span>
                            <div class="progress-wrap type2">
                                <div class="progress-bar" style="width: 25%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="progress">
                        <div>
                            <span class="label">ìë…€</span>
                            <div class="progress-wrap type2">
                                <div class="progress-bar" style="width: 70%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="progress">
                        <div>
                            <span class="label">í—Œí˜ˆ</span>
                            <div class="progress-wrap type">
                                <div class="progress-bar" style="width: 10%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="progress-con">
                    <div class="progress">
                        <div>
                            <span class="label">ìœ¡ì•„</span>
                            <div class="progress-wrap type3">
                                <div class="progress-bar" style="width: 50%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="progress">
                        <div>
                            <span class="label">ë‚œì„</span>
                            <div class="progress-wrap type3">
                                <div class="progress-bar" style="width: 25%"></div>
                                <div class="progress-data">
                                    <span>10</span>
                                    <span>20</span>
                                    <span>30</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="progress">
                        <div style="display: none;"><!-- div ì¶”ê°€ ëìŠµë‹ˆë‹¤. ì‚­ì œì‹œ ì—¬ê¸° divë¥¼ ìˆ¨ê¹€ì²˜ë¦¬ -->
                            <span class="label">ê°€ì¡±</span>
                            <div class="progress-wrap type3">
                                <div class="progress-bar" style="width: 25%"></div>
                                <div class="progress-data">
                                    <span>100</span>
                                    <span>200</span>
                                    <span>300</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="box" style="grid-column: span 2; ">
            <div class="body">
                <div class="form-wrap">
                    <div class="form-grid-search">
                        <div class="form">
                            <span class="label">ì‹ ì²­ì¼</span>
                            <span>
                                <div class="input-daterange input-group datepicker-wrap" id="">
                                    <input type="text" class="input-sm form-control" name="" />
                                    <span class="input-group-addon">~</span>
                                    <input type="text" class="input-sm form-control" name="" />
                                </div>
                            </span>
                            <span class="label">íœ´ë¬´ìœ í˜•</span> 
                            <span>
                                <div class="form-group select-custom" style="width: ;">
                                    <select id="" class="fn-select js-basic-single">
                                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                        <option value="seoul">ì„œìš¸</option>
                                        <option value="busan">ë¶€ì‚°</option>
                                        <option value="incheon">ì¸ì²œ</option>
                                        <option value="daegu">ëŒ€êµ¬</option>
                                        <option value="daejeon">ëŒ€ì „</option>
                                        <option value="gwangju">ê´‘ì£¼</option>
                                        <option value="ulsan">ìš¸ì‚°</option>
                                        <option value="sejong">ì„¸ì¢…</option>
                                    </select>
                                </div>
                            </span>
                            <span class="label">ê²°ì¬ìƒíƒœ</span>
                            <span>
                                <div class="form-group select-custom">
                                    <select id="" class="fn-select js-basic-single">
                                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                        <option value="seoul">ì„œìš¸</option>
                                        <option value="busan">ë¶€ì‚°</option>
                                        <option value="incheon">ì¸ì²œ</option>
                                        <option value="daegu">ëŒ€êµ¬</option>
                                        <option value="daejeon">ëŒ€ì „</option>
                                        <option value="gwangju">ê´‘ì£¼</option>
                                        <option value="ulsan">ìš¸ì‚°</option>
                                        <option value="sejong">ì„¸ì¢…</option>
                                    </select>
                                </div>
                            </span>
                        </div>
                    </div>
                    <button type="button" class="btn icon-btn search">
                        <span>ì¡°íšŒ</span>
                    </button>
                </div>
                
            </div>
        </div>

        <div class="box type1" style="grid-column: span 2; ">
            <div class="header">
                <h3>ì‹ ì²­ë‚´ì—­<span>total 13ê±´</span></h3>
                <button type="button" class="btn btn-primary">ì‹ ê·œì‹ ì²­</button>
            </div>
            <div class="body">

                <div id="attendanceGrid" class="grid-wrap"></div>
                <br><br>
                <div id="emptyGrid" class="grid-wrap"></div>
                
            </div>
        </div>

    </div>
</div>

<!-- ì—°ì°¨ì¿¼í„° ìƒì„¸ë‚´ì—­ ëª¨ë‹¬íŒì—… -->
<div class="modal " id="modal1111">
    <div class="modal-content" style="width: 700px;">
        <div class="modal-header">
            <h2>ì—°ì°¨ì¿¼í„° ìƒì„¸ë‚´ì—­</h2>
        </div>
        <div class="modal-body">

            <div id="annualGrid" class="grid-wrap"></div>

            
        </div>
        <div class="modal-footer">
            <button class="btn btn-normal close-btn fn-modal-close">ë‹«ê¸°</button>
        </div>
    </div>
</div>

</body>
<script>
    $(document).ready(function() {
        // 1. ê¸°ë³¸ Select2
        $('.fn-select').select2({
            placeholder: 'ì„ íƒí•˜ì„¸ìš”',
            allowClear: true
        });
        
        // ì„ íƒ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        $('.js-basic-single, .js-grouped, .js-no-search').on('change', function() {
            console.log('ì„ íƒëœ ê°’:', $(this).val());
        });
        
        $('.js-multiple, .js-tags').on('change', function() {
            console.log('ì„ íƒëœ ê°’ë“¤:', $(this).val());
        });
    });
    
    // ë‹¨ì¼ ì„ íƒê°’ ì¡°íšŒ
    function getValue(selectId) {
        const value = $('#' + selectId).val();
        const text = $('#' + selectId + ' option:selected').text();
        const resultBox = $('#result' + selectId.replace('select', ''));
        
        if (value) {
            resultBox.html(
                '<h4>âœ… ì„ íƒëœ ê°’:</h4>' +
                '<p><strong>Value:</strong> ' + value + '</p>' +
                '<p><strong>Text:</strong> ' + text + '</p>'
            );
            resultBox.addClass('show');
        } else {
            alert('ì„ íƒëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.');
            resultBox.removeClass('show');
        }
    }

    // Select ì´ˆê¸°í™”
    function resetSelect(selectId) {
        $('#' + selectId).val(null).trigger('change');
        $('#result' + selectId.replace('select', '')).removeClass('show');
        alert('ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    
    // í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ê°’ ì„¤ì •
    function setValueProgrammatically(selectId, value) {
        $('#' + selectId).val(value).trigger('change');
        alert('ê°’ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤: ' + value);
    }
</script>
</html>